<!DOCTYPE html>
<html>

<head>
  <title>DMC WEB | Detail Pemesanan</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>

<body style="background: white;">
  <div class="navbar sticky-top navbar-expand-lg navbar-light bg-dark">
    <div class="container">
      <div class="row">
        <a class="navbar-brand" href="homeActivity">
          <img class="img-fluid" src="css/bakudan.png" width="40" height="40">
        </a>

        <h1 class="text-white" style="margin: auto;">Harihari Pergi</h1>
      </div>
      <form id="back" onsubmit="back()">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item mr-3">
            <input type="submit" value="Back" class="nav-link text-white bg-transparent border-0">
          </li>
        </ul>
      </form>
    </div>
  </div>

  <div class="container" style="padding:3%;">
    <main>
      <h1>Detail Pemesanan</h1>
      <div class="row g-5">
        <div class="col-md-5 col-lg-4 order-md-last">
          <h4 class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-primary">Total Biaya</span>
          </h4>
          <ul class="list-group mb-3">
            <li class="list-group-item d-flex justify-content-between lh-sm">
              <div>
                <h6 class="my-0">Harga Tiket</h6>
              </div>
              <span id="total1" class="text-muted"></span>
              <span id="harga_awal"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between lh-sm">
              <div>
                <h6 class="my-0">Service Tax</h6>
              </div>
              <span id="tax" class="text-muted"></span>
              <span>10 %</span>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span>Total</span>
              <span id="totalHasil"></span>
            </li>
          </ul>
        </div>
        <div class="col-md-7 col-lg-8">
          <form class="needs-validation" action="pembayaran">
            <div class="row g-3">
              <div class="col-sm-12">
                <label for="firstName" class="form-label my-1">Nama Lengkap</label>
                <input type="text" class="form-control" id="name" disabled>
              </div>
              <div class="col-sm-12">
                <label for="nama_travel" class="form-label my-1">Nama Travel</label>
                <input type="text" class="form-control" id="nama_travel" disabled>
              </div>
              <div class="col-sm-12">
                <label for="kota_asal" class="form-label my-1">Kota Asal</label>
                <input type="text" class="form-control" id="kota_asal" disabled>
              </div>
              <div class="col-sm-12">
                <label for="kota_tujuan" class="form-label my-1">Kota Tujuan</label>
                <input type="text" class="form-control" id="kota_tujuan" disabled>
              </div>
              <div class="col-sm-12">
                <label for="tgl" class="form-label my-1">Tanggal Berangkat</label>
                <input type="text" class="form-control" id="tgl" disabled>
              </div>
            </div>
            <hr class="my-4">
            <button class="w-100 btn btn-primary btn-lg my-4" type="submit" id="btn" onclick="saveTotal()">Lanjut ke Pembayaran</button>
          </form>
        </div>
      </div>
    </main>
  </div>

  <section>
    <!-- Footer -->
    <footer class="bg-secondary text-white">
      <!-- Grid container -->
      <div class="container p-4">
        <!--Grid row-->
        <div class="row">
          <!--Grid column-->
          <div class="col-lg-9 col-md-12 mb-4 mb-md-0">
            <h5 class="text-uppercase">Kelompok DMC</h5>

            <p>
              Adha Surya <br>
              Abdillah Hasan <br>
              Gerry William <br>
              Naufel Abiyyu <br>
              Rodo Idola
            </p>
          </div>
          <!--Grid column-->

          <!--Grid column-->
          <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
            <h5 class="text-uppercase">Social Media</h5>
            <ul class="list-unstyled mb-0">
              <li class="my-2">
                <a href="#!" class="text-white"><i class="bi bi-facebook"></i></a> Facebook
              </li>
              <li class="my-2">
                <a href="#!" class="text-white"><i class="bi bi-twitter"></i></a> Twitter
              </li>
              <li class="my-2">
                <a href="#!" class="text-white"><i class="bi bi-whatsapp"></i></a> WhatsApp
              </li>
              <li class="my-2">
                <a href="#!" class="text-white"><i class="bi bi-instagram"></i></a> Instagram
              </li>
            </ul>
          </div>
          <!--Grid column-->
        </div>
        <!--Grid row-->
      </div>
      <!-- Grid container -->

      <!-- Copyright -->
      <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        Â© 2022 Copyright: DMC
      </div>
      <!-- Copyright -->
    </footer>
    <!-- Footer -->
  </section>

  <script src="https://code.jquery.com/jquery-3.6.1.min.js"
    integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script type="text/javascript">
    const baseURL = "http://localhost:3000"

    localStorage.removeItem("total")

    let email = localStorage.getItem('email')
    document.getElementById("name").value = email
    let urutan = localStorage.getItem('urutan')
    let total = 0


    //Load Data Pesawat
    function get_plane() {
      $.getJSON(baseURL + "/getOnePlanes/" + urutan, (data) => {
        data.data.forEach(function (isi) {
          document.getElementById("nama_travel").value = isi.nama_pesawat
          document.getElementById("kota_asal").value = isi.asal_pesawat
          document.getElementById("kota_tujuan").value = isi.tujuan_pesawat
          document.getElementById("tgl").value = isi.jam_terbang
          $('#harga_awal').html(isi.harga_pesawat);
          total = isi.harga_pesawat
          total = total + (total * 0.1)
          $('#totalHasil').html(total);
        })
      })
    }

    //


    //Load Data Kereta

    function get_train() {
      $.getJSON(baseURL + "/getOneTrains/" + urutan, (data) => {
        data.data.forEach(function (isi) {
          document.getElementById("nama_travel").value = isi.nama_kereta
          document.getElementById("kota_asal").value = isi.berangkat_kereta
          document.getElementById("kota_tujuan").value = isi.tiba_kereta
          document.getElementById("tgl").value = isi.jadwal_kereta
          $('#harga_awal').html(isi.harga_tiket_kereta);
          total = isi.harga_tiket_kereta
          total = total + (total * 0.1)
          $('#totalHasil').html(total);
        })
      })
    }

    //
    
    //Load Data Travel

    function get_travel() {
      $.getJSON(baseURL + "/getOneTravels/" + urutan, (data) => {
        data.data.forEach(function (isi) {
          document.getElementById("nama_travel").value = isi.nama_travel
          document.getElementById("kota_asal").value = isi.waktu_berangkat
          document.getElementById("kota_tujuan").value = isi.waktu_tiba
          document.getElementById("tgl").value = isi.jadwal_travel
          $('#harga_awal').html(isi.harga_travel);
          total = isi.harga_travel
          total = total + (total * 0.1)
          $('#totalHasil').html(total);
        })
      })
    }

    //

    $.getJSON(baseURL + "/getEmailUser/" + email, (data) => {
        data.data.forEach(function (isi) {
          document.getElementById("name").value = isi.nama + " " + isi.nama_belakang
        })
      })

    if (localStorage.getItem("nTravel") == "pesawat") {
      window.onload = get_plane();
    } else if (localStorage.getItem("nTravel") == "kereta") {
      window.onload = get_train();
    } else if (localStorage.getItem("nTravel") == "travel") {
      window.onload = get_travel();
    } 

    function back() {
      if (localStorage.getItem("nTravel") == "pesawat") {
        document.getElementById("back").action = "tiketPesawat";
      } else if (localStorage.getItem("nTravel") == "kereta") {
        document.getElementById("back").action = "tiketKereta";
      } else if (localStorage.getItem("nTravel") == "travel") {
        document.getElementById("back").action = "tiketTravel";
      }
    }

    function saveTotal(){
      var total = $('#totalHasil').html();

      localStorage.setItem("total", total)
    }

  </script>
</body>

</html>